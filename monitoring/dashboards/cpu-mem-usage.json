{"annotations": {"list": [{"builtIn": 1,"datasource": "-- Grafana --","enable": true,"hide": true,"iconColor": "rgba(0, 211, 255, 1)","name": "Annotations & Alerts","type": "dashboard"}]},"description": "Monitors Kubernetes cluster using Prometheus. Shows overall cluster CPU / Memory / Filesystem usage as well as individual pod, containers, systemd services statistics. Uses cAdvisor metrics only.","editable": true,"gnetId": 315,"graphTooltip": 0,"id": 9,"iteration": 1551359253674,"links": [],"panels": [{"aliasColors": {},"bars": false,"dashLength": 10,"dashes": false,"datasource": "Prometheus","decimals": 3,"editable": true,"error": false,"fill": 0,"grid": {},"gridPos": {"h": 7,"w": 24,"x": 0,"y": 0},"height": "","id": 24,"isNew": true,"legend": {"alignAsTable": true,"avg": true,"current": true,"hideEmpty": false,"hideZero": false,"max": false,"min": false,"rightSide": true,"show": true,"sideWidth": 600,"sort": "current","sortDesc": true,"total": false,"values": true},"lines": true,"linewidth": 2,"links": [],"nullPointMode": "connected","paceLength": 10,"percentage": false,"pointradius": 5,"points": false,"renderer": "flot","seriesOverrides": [],"spaceLength": 10,"stack": false,"steppedLine": true,"targets": [{"expr": "sum (rate (container_cpu_usage_seconds_total{image!=\"\",name=~\"^k8s_.*\",container!=\"POD\",kubernetes_io_hostname=~\"^$Node$\", namespace=~\"^$Namespace$\"}[1m])) by (container, pod)","format": "time_series","hide": false,"interval": "10s","intervalFactor": 1,"legendFormat": "pod: {{pod}} ","metric": "container_cpu","refId": "A","step": 10},{"expr": "sum (rate (container_cpu_usage_seconds_total{image!=\"\",name!~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\", namespace=~\"^$Namespace$\"}[1m])) by (kubernetes_io_hostname, name, image)","format": "time_series","hide": false,"interval": "10s","intervalFactor": 1,"legendFormat": "docker: {{kubernetes_io_hostname}} | {{image}} ({{name}})","metric": "container_cpu","refId": "B","step": 10},{"expr": "sum (rate (container_cpu_usage_seconds_total{rkt_container!=\"\",kubernetes_io_hostname=~\"^$Node$\", namespace=~\"^$Namespace$\"}[1m])) by (kubernetes_io_hostname, rkt_container)","format": "time_series","interval": "10s","intervalFactor": 1,"legendFormat": "rkt: {{kubernetes_io_hostname}} | {{rkt_container}}","metric": "container_cpu","refId": "C","step": 10}],"thresholds": [],"timeFrom": null,"timeRegions": [],"timeShift": null,"title": "Containers CPU usage (1m avg)","tooltip": {"msResolution": true,"shared": true,"sort": 2,"value_type": "cumulative"},"type": "graph","xaxis": {"buckets": null,"mode": "time","name": null,"show": true,"values": []},"yaxes": [{"format": "none","label": "cores","logBase": 1,"max": null,"min": null,"show": true},{"format": "short","label": null,"logBase": 1,"max": null,"min": null,"show": false}],"yaxis": {"align": false,"alignLevel": null}},{"aliasColors": {},"bars": false,"dashLength": 10,"dashes": false,"datasource": "Prometheus","decimals": 3,"editable": true,"error": false,"fill": 0,"grid": {},"gridPos": {"h": 5,"w": 24,"x": 0,"y": 7},"height": "","id": 55,"isNew": true,"legend": {"alignAsTable": true,"avg": true,"current": true,"hideEmpty": false,"hideZero": false,"max": false,"min": false,"rightSide": true,"show": true,"sideWidth": 600,"sort": "current","sortDesc": true,"total": false,"values": true},"lines": true,"linewidth": 2,"links": [],"nullPointMode": "connected","paceLength": 10,"percentage": false,"pointradius": 5,"points": false,"renderer": "flot","seriesOverrides": [],"spaceLength": 10,"stack": false,"steppedLine": true,"targets": [{"expr": "sum (rate (container_cpu_usage_seconds_total{image!=\"\",name=~\"^k8s_.*\",container!=\"POD\",kubernetes_io_hostname=~\"^$Node$\", namespace=~\"^$Namespace$\"}[1m]))","format": "time_series","hide": false,"interval": "10s","intervalFactor": 1,"legendFormat": "Total","metric": "container_cpu","refId": "A","step": 10},{"expr": "sum (rate (container_cpu_usage_seconds_total{image!=\"\",name!~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\", namespace=~\"^$Namespace$\"}[1m])) by (kubernetes_io_hostname, name, image)","format": "time_series","hide": false,"interval": "10s","intervalFactor": 1,"legendFormat": "docker: {{kubernetes_io_hostname}} | {{image}} ({{name}})","metric": "container_cpu","refId": "B","step": 10},{"expr": "sum (rate (container_cpu_usage_seconds_total{rkt_container!=\"\",kubernetes_io_hostname=~\"^$Node$\", namespace=~\"^$Namespace$\"}[1m])) by (kubernetes_io_hostname, rkt_container)","format": "time_series","interval": "10s","intervalFactor": 1,"legendFormat": "rkt: {{kubernetes_io_hostname}} | {{rkt_container}}","metric": "container_cpu","refId": "C","step": 10}],"thresholds": [],"timeFrom": null,"timeRegions": [],"timeShift": null,"title": "Total CPU usage (1m avg)","tooltip": {"msResolution": true,"shared": true,"sort": 2,"value_type": "cumulative"},"type": "graph","xaxis": {"buckets": null,"mode": "time","name": null,"show": true,"values": []},"yaxes": [{"format": "none","label": "cores","logBase": 1,"max": null,"min": null,"show": true},{"format": "short","label": null,"logBase": 1,"max": null,"min": null,"show": false}],"yaxis": {"align": false,"alignLevel": null}},{"aliasColors": {},"bars": false,"dashLength": 10,"dashes": false,"datasource": "Prometheus","decimals": 2,"editable": true,"error": false,"fill": 0,"grid": {},"gridPos": {"h": 8,"w": 24,"x": 0,"y": 12},"id": 27,"isNew": true,"legend": {"alignAsTable": true,"avg": true,"current": true,"max": false,"min": false,"rightSide": true,"show": true,"sideWidth": 600,"sort": "current","sortDesc": true,"total": false,"values": true},"lines": true,"linewidth": 2,"links": [],"nullPointMode": "connected","paceLength": 10,"percentage": false,"pointradius": 5,"points": false,"renderer": "flot","seriesOverrides": [],"spaceLength": 10,"stack": false,"steppedLine": true,"targets": [{"expr": "sum (container_memory_working_set_bytes{image!=\"\",name=~\"^k8s_.*\",container!=\"POD\",kubernetes_io_hostname=~\"^$Node$\", namespace=~\"^$Namespace$\"}) by (container, pod)","format": "time_series","hide": false,"interval": "10s","intervalFactor": 1,"legendFormat": "{{pod}}","metric": "container_memory_usage:sort_desc","refId": "A","step": 10},{"expr": "sum (container_memory_working_set_bytes{image!=\"\",name!~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\", namespace=~\"^$Namespace$\"}) by (kubernetes_io_hostname, name, image)","format": "time_series","hide": false,"interval": "10s","intervalFactor": 1,"legendFormat": "docker: {{kubernetes_io_hostname}} | {{image}} ({{name}})","metric": "container_memory_usage:sort_desc","refId": "B","step": 10},{"expr": "sum (container_memory_working_set_bytes{rkt_container!=\"\",kubernetes_io_hostname=~\"^$Node$\", namespace=~\"^$Namespace$\"}) by (kubernetes_io_hostname, rkt_container)","format": "time_series","hide": false,"interval": "10s","intervalFactor": 1,"legendFormat": "rkt: {{kubernetes_io_hostname}} | {{rkt_container}}","metric": "container_memory_usage:sort_desc","refId": "C","step": 10}],"thresholds": [],"timeFrom": null,"timeRegions": [],"timeShift": null,"title": "Containers memory usage","tooltip": {"msResolution": false,"shared": true,"sort": 2,"value_type": "cumulative"},"type": "graph","xaxis": {"buckets": null,"mode": "time","name": null,"show": true,"values": []},"yaxes": [{"format": "decbytes","label": null,"logBase": 1,"max": null,"min": null,"show": true},{"format": "short","label": null,"logBase": 1,"max": null,"min": null,"show": false}],"yaxis": {"align": false,"alignLevel": null}},{"aliasColors": {},"bars": false,"dashLength": 10,"dashes": false,"datasource": "Prometheus","decimals": 2,"editable": true,"error": false,"fill": 0,"grid": {},"gridPos": {"h": 6,"w": 24,"x": 0,"y": 20},"id": 56,"isNew": true,"legend": {"alignAsTable": true,"avg": true,"current": true,"max": false,"min": false,"rightSide": true,"show": true,"sideWidth": 600,"sort": "current","sortDesc": true,"total": false,"values": true},"lines": true,"linewidth": 2,"links": [],"nullPointMode": "connected","paceLength": 10,"percentage": false,"pointradius": 5,"points": false,"renderer": "flot","seriesOverrides": [],"spaceLength": 10,"stack": false,"steppedLine": true,"targets": [{"expr": "sum (container_memory_working_set_bytes{image!=\"\",name=~\"^k8s_.*\",container!=\"POD\",kubernetes_io_hostname=~\"^$Node$\", namespace=~\"^$Namespace$\"}) ","format": "time_series","hide": false,"interval": "10s","intervalFactor": 1,"legendFormat": "Total","metric": "container_memory_usage:sort_desc","refId": "A","step": 10},{"expr": "sum (container_memory_working_set_bytes{image!=\"\",name!~\"^k8s_.*\",kubernetes_io_hostname=~\"^$Node$\", namespace=~\"^$Namespace$\"}) by (kubernetes_io_hostname, name, image)","format": "time_series","hide": false,"interval": "10s","intervalFactor": 1,"legendFormat": "docker: {{kubernetes_io_hostname}} | {{image}} ({{name}})","metric": "container_memory_usage:sort_desc","refId": "B","step": 10},{"expr": "sum (container_memory_working_set_bytes{rkt_container!=\"\",kubernetes_io_hostname=~\"^$Node$\", namespace=~\"^$Namespace$\"}) by (kubernetes_io_hostname, rkt_container)","format": "time_series","hide": false,"interval": "10s","intervalFactor": 1,"legendFormat": "rkt: {{kubernetes_io_hostname}} | {{rkt_container}}","metric": "container_memory_usage:sort_desc","refId": "C","step": 10}],"thresholds": [],"timeFrom": null,"timeRegions": [],"timeShift": null,"title": "Total memory usage","tooltip": {"msResolution": false,"shared": true,"sort": 2,"value_type": "cumulative"},"type": "graph","xaxis": {"buckets": null,"mode": "time","name": null,"show": true,"values": []},"yaxes": [{"format": "decbytes","label": null,"logBase": 1,"max": null,"min": null,"show": true},{"format": "short","label": null,"logBase": 1,"max": null,"min": null,"show": false}],"yaxis": {"align": false,"alignLevel": null}}],"refresh": "5m","schemaVersion": 18,"style": "dark","tags": ["kubernetes"],"templating": {"list": [{"allValue": ".*","current": {"text": "All","value": "$__all"},"datasource": "Prometheus","definition": "label_values(kubernetes_io_hostname)","hide": 0,"includeAll": true,"label": null,"multi": false,"name": "Node","options": [],"query": "label_values(kubernetes_io_hostname)","refresh": 1,"regex": "","skipUrlSync": false,"sort": 0,"tagValuesQuery": "","tags": [],"tagsQuery": "","type": "query","useTags": false},{"allValue": ".*","current": {"text": "coss","value": "coss"},"datasource": "Prometheus","definition": "label_values(namespace)","hide": 0,"includeAll": true,"label": null,"multi": false,"name": "Namespace","options": [],"query": "label_values(namespace)","refresh": 1,"regex": "","skipUrlSync": false,"sort": 0,"tagValuesQuery": "","tags": [],"tagsQuery": "","type": "query","useTags": false}]},"time": {"from": "now-30m","to": "now"},"timepicker": {"refresh_intervals": ["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options": ["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone": "browser","title": "CPU & Memory usage","uid": "6xmN24xmk","version": 1}
