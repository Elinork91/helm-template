{"annotations": {"list": [{"builtIn": 1,"datasource": "-- Grafana --","enable": true,"hide": true,"iconColor": "rgba(0, 211, 255, 1)","name": "Annotations & Alerts","type": "dashboard"}]},"description": "Rabbitmq stats and alerting using RabbitMQ Exporter (https://github.com/kbudde/rabbitmq_exporter)","editable": true,"gnetId": 4279,"graphTooltip": 1,"id": 2,"iteration": 1551358655767,"links": [],"panels": [{"columns": [],"datasource": "Prometheus","fontSize": "100%","gridPos": {"h": 14,"w": 12,"x": 0,"y": 0},"id": 27,"links": [],"pageSize": 100,"scroll": true,"showHeader": true,"sort": {"col": 2,"desc": false},"styles": [{"alias": "Time","dateFormat": "YYYY-MM-DD HH:mm:ss","pattern": "Time","type": "hidden"},{"alias": "Queue","colorMode": null,"colors": ["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat": "YYYY-MM-DD HH:mm:ss","decimals": 2,"mappingType": 1,"pattern": "queue","thresholds": [],"type": "string","unit": "short"},{"alias": "Consumers","colorMode": "cell","colors": ["#890f02","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat": "YYYY-MM-DD HH:mm:ss","decimals": 0,"link": false,"mappingType": 1,"pattern": "Value","preserveFormat": true,"sanitize": false,"thresholds": ["1","1"],"type": "string","unit": "short","valueMaps": []},{"alias": "Utilisation","colorMode": null,"colors": ["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat": "YYYY-MM-DD HH:mm:ss","decimals": null,"mappingType": 1,"pattern": "Value #B","thresholds": [],"type": "number","unit": "short"},{"alias": "","colorMode": null,"colors": ["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"decimals": 2,"pattern": "/.*/","thresholds": [],"type": "number","unit": "short"}],"targets": [{"expr": "sum(rabbitmq_queue_consumers{queue!~\"^dead-letters.*\", namespace=~\"^$namespace$\"}) by (queue)","format": "table","instant": true,"intervalFactor": 1,"legendFormat": "","refId": "A"},{"expr": "sum(rabbitmq_queue_consumer_utilisation{queue!~\"^dead-letters.*\", namespace=~\"^$namespace$\"}) by (queue)","format": "table","hide": true,"instant": true,"intervalFactor": 1,"refId": "B"}],"title": "Number of consumers","transform": "table","type": "table"},{"columns": [],"datasource": "Prometheus","fontSize": "100%","gridPos": {"h": 14,"w": 12,"x": 12,"y": 0},"id": 19,"links": [],"pageSize": null,"scroll": true,"showHeader": true,"sort": {"col": 3,"desc": false},"styles": [{"alias": "Time","dateFormat": "YYYY-MM-DD HH:mm:ss","pattern": "Time","type": "hidden"},{"alias": "Received","colorMode": "cell","colors": ["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","#ef843c"],"dateFormat": "YYYY-MM-DD HH:mm:ss","decimals": null,"link": false,"mappingType": 1,"pattern": "Value #A","thresholds": ["0","","1"],"type": "number","unit": "short"},{"alias": "Published","colorMode": "cell","colors": ["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","#ef843c"],"dateFormat": "YYYY-MM-DD HH:mm:ss","decimals": null,"mappingType": 1,"pattern": "Value #B","thresholds": ["","","1"],"type": "number","unit": "short"},{"alias": "Queue","colorMode": null,"colors": ["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"dateFormat": "YYYY-MM-DD HH:mm:ss","decimals": 2,"mappingType": 1,"pattern": "queue","thresholds": [],"type": "number","unit": "short"},{"alias": "","colorMode": null,"colors": ["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],"decimals": 2,"pattern": "/.*/","thresholds": [],"type": "number","unit": "short"}],"targets": [{"expr": "sum(rabbitmq_queue_messages_published_total{queue!~\"^dead-letters.*\", namespace=~\"^$namespace$\"}) by (queue)","format": "table","instant": true,"intervalFactor": 1,"legendFormat": "received","refId": "A"},{"expr": "sum(rabbitmq_queue_messages_delivered_total{queue!~\"^dead-letters.*\", namespace=~\"^$namespace$\"}) by (queue)","format": "table","hide": false,"instant": true,"intervalFactor": 1,"legendFormat": "published","refId": "B"}],"title": "Messages total","transform": "table","type": "table"},{"aliasColors": {},"bars": false,"dashLength": 10,"dashes": false,"datasource": "Prometheus","decimals": 0,"fill": 0,"gridPos": {"h": 9,"w": 12,"x": 0,"y": 14},"id": 10,"legend": {"alignAsTable": true,"avg": true,"current": true,"hideEmpty": false,"hideZero": false,"max": false,"min": false,"rightSide": true,"show": true,"sort": "current","sortDesc": true,"total": false,"values": true},"lines": true,"linewidth": 2,"links": [],"nullPointMode": "connected","paceLength": 10,"percentage": false,"pointradius": 5,"points": false,"renderer": "flot","seriesOverrides": [],"spaceLength": 10,"stack": false,"steppedLine": false,"targets": [{"expr": "rabbitmq_queue_consumers{queue!~\"^dead-letters.*\",namespace=~\"^$namespace$\"}","format": "time_series","intervalFactor": 1,"legendFormat": "{{queue}}","refId": "A"}],"thresholds": [],"timeFrom": null,"timeRegions": [],"timeShift": null,"title": "Consumers per queue","tooltip": {"shared": true,"sort": 2,"value_type": "individual"},"type": "graph","xaxis": {"buckets": null,"mode": "time","name": null,"show": true,"values": []},"yaxes": [{"decimals": null,"format": "none","label": null,"logBase": 1,"max": null,"min": null,"show": true},{"format": "short","label": null,"logBase": 1,"max": null,"min": null,"show": false}],"yaxis": {"align": false,"alignLevel": null}},{"aliasColors": {},"bars": false,"dashLength": 10,"dashes": false,"datasource": "Prometheus","fill": 0,"gridPos": {"h": 9,"w": 12,"x": 12,"y": 14},"id": 16,"legend": {"alignAsTable": true,"avg": true,"current": true,"max": false,"min": false,"rightSide": true,"show": true,"sort": "avg","sortDesc": true,"total": false,"values": true},"lines": true,"linewidth": 2,"links": [],"nullPointMode": "connected","paceLength": 10,"percentage": false,"pointradius": 5,"points": false,"renderer": "flot","seriesOverrides": [],"spaceLength": 10,"stack": false,"steppedLine": true,"targets": [{"expr": "sum ( rate(rabbitmq_queue_messages_delivered_total{queue!~\"^dead-letters.*\", namespace=~\"^$namespace$\"}[1m])) by (queue)","format": "time_series","interval": "10s","intervalFactor": 1,"legendFormat": "{{queue}}","refId": "A"}],"thresholds": [],"timeFrom": null,"timeRegions": [],"timeShift": null,"title": "Messages delivered / s","tooltip": {"shared": true,"sort": 2,"value_type": "individual"},"type": "graph","xaxis": {"buckets": null,"mode": "time","name": null,"show": true,"values": []},"yaxes": [{"format": "short","label": "Messages","logBase": 1,"max": null,"min": "0","show": true},{"format": "short","label": null,"logBase": 1,"max": null,"min": null,"show": true}],"yaxis": {"align": false,"alignLevel": null}}],"refresh": "1m","schemaVersion": 18,"style": "dark","tags": ["rabbitmq","prometheus"],"templating": {"list": [{"current": {"text": "Prometheus","value": "Prometheus"},"hide": 0,"label": null,"name": "datasource","options": [],"query": "prometheus","refresh": 1,"regex": "","skipUrlSync": false,"type": "datasource"},{"allValue": null,"current": {"text": "All","value": "$__all"},"datasource": "Prometheus","definition": "","hide": 0,"includeAll": true,"label": null,"multi": true,"name": "node","options": [],"query": "label_values(rabbitmq_running, node)","refresh": 1,"regex": "","skipUrlSync": false,"sort": 0,"tagValuesQuery": "","tags": [],"tagsQuery": "","type": "query","useTags": false},{"allValue": null,"current": {"text": "ch-infrastructure","value": ["ch-infrastructure"]},"datasource": "Prometheus","definition": "label_values(namespace)","hide": 0,"includeAll": true,"label": null,"multi": true,"name": "namespace","options": [],"query": "label_values(namespace)","refresh": 1,"regex": "","skipUrlSync": false,"sort": 0,"tagValuesQuery": "","tags": [],"tagsQuery": "","type": "query","useTags": false}]},"time": {"from": "now-1h","to": "now"},"timepicker": {"refresh_intervals": ["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options": ["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone": "browser","title": "Consumers","uid": "IgqkK8Xma","version": 1}
