{"annotations": {"list": [{"builtIn": 1,"datasource": "-- Grafana --","enable": true,"hide": true,"iconColor": "rgba(0, 211, 255, 1)","name": "Annotations & Alerts","type": "dashboard"}]},"description": "Rabbitmq stats and alerting using RabbitMQ Exporter (https://github.com/kbudde/rabbitmq_exporter)","editable": true,"gnetId": 4279,"graphTooltip": 1,"id": 6,"iteration": 1621344718240,"links": [],"panels": [{"cacheTimeout": null,"datasource": "Prometheus","fieldConfig": {"defaults": {"color": {"mode": "thresholds"},"mappings": [{"id": 0,"op": "=","text": "N/A","type": 1,"value": "null"}],"max": 100000,"min": 0,"thresholds": {"mode": "absolute","steps": [{"color": "rgb(47, 184, 32)","value": null},{"color": "rgba(237, 129, 40, 0.89)","value": 50000},{"color": "#d44a3a","value": 80000}]},"unit": "short"},"overrides": []},"gridPos": {"h": 7,"w": 7,"x": 0,"y": 0},"id": 31,"interval": null,"links": [],"maxDataPoints": 100,"options": {"orientation": "horizontal","reduceOptions": {"calcs": ["lastNotNull"],"fields": "","values": false},"showThresholdLabels": false,"showThresholdMarkers": true,"text": {}},"pluginVersion": "7.5.2","targets": [{"exemplar": true,"expr": "sum(rabbitmq_queue_messages_ready{namespace=~\"^$namespace$\"})","format": "time_series","instant": false,"interval": "10s","intervalFactor": 1,"legendFormat": "","refId": "A"}],"title": "Currently messages in RMQ","type": "gauge"},{"cacheTimeout": null,"datasource": "Prometheus","fieldConfig": {"defaults": {"color": {"mode": "thresholds"},"mappings": [{"id": 0,"op": "=","text": "N/A","type": 1,"value": "null"}],"thresholds": {"mode": "absolute","steps": [{"color": "green","value": null},{"color": "red","value": 80}]},"unit": "short"},"overrides": []},"gridPos": {"h": 7,"w": 5,"x": 7,"y": 0},"id": 32,"interval": null,"links": [],"maxDataPoints": 100,"options": {"colorMode": "value","graphMode": "area","justifyMode": "auto","orientation": "auto","reduceOptions": {"calcs": ["lastNotNull"],"fields": "","values": false},"text": {},"textMode": "auto"},"pluginVersion": "7.5.2","targets": [{"exemplar": true,"expr": "sum(rabbitmq_queue_messages_published_total)","format": "time_series","instant": false,"interval": "10s","intervalFactor": 1,"legendFormat": "","refId": "A"}],"title": "Messages published in total","type": "stat"},{"aliasColors": {},"bars": false,"dashLength": 10,"dashes": false,"datasource": "Prometheus","decimals": 0,"fieldConfig": {"defaults": {},"overrides": []},"fill": 0,"fillGradient": 0,"gridPos": {"h": 7,"w": 12,"x": 12,"y": 0},"hiddenSeries": false,"id": 5,"legend": {"alignAsTable": true,"avg": true,"current": true,"max": false,"min": false,"rightSide": true,"show": true,"total": false,"values": true},"lines": true,"linewidth": 2,"links": [],"nullPointMode": "connected","options": {"alertThreshold": true},"paceLength": 10,"percentage": false,"pluginVersion": "7.5.2","pointradius": 3,"points": false,"renderer": "flot","seriesOverrides": [],"spaceLength": 10,"stack": false,"steppedLine": true,"targets": [{"expr": "rabbitmq_connections{namespace=~\"^$namespace$\"}","format": "time_series","hide": false,"intervalFactor": 2,"legendFormat": "connections","metric": "rabbitmq_connectionsTotal","refId": "A","step": 2},{"expr": "rabbitmq_channels{namespace=~\"^$namespace$\"}","format": "time_series","hide": false,"intervalFactor": 2,"legendFormat": "channels","refId": "B"},{"expr": "rabbitmq_consumers{namespace=~\"^$namespace$\"}","format": "time_series","hide": false,"intervalFactor": 2,"legendFormat": "consumers","refId": "C"}],"thresholds": [],"timeFrom": null,"timeRegions": [],"timeShift": null,"title": "Usage","tooltip": {"shared": true,"sort": 2,"value_type": "individual"},"type": "graph","xaxis": {"buckets": null,"mode": "time","name": null,"show": true,"values": []},"yaxes": [{"decimals": 0,"format": "short","label": "","logBase": 1,"max": null,"min": "0","show": true},{"format": "short","label": null,"logBase": 1,"max": null,"min": null,"show": true}],"yaxis": {"align": false,"alignLevel": null}},{"aliasColors": {},"bars": false,"dashLength": 10,"dashes": false,"datasource": "Prometheus","decimals": null,"fieldConfig": {"defaults": {},"overrides": []},"fill": 1,"fillGradient": 0,"gridPos": {"h": 9,"w": 24,"x": 0,"y": 7},"hiddenSeries": false,"id": 8,"legend": {"alignAsTable": true,"avg": true,"current": true,"hideEmpty": false,"hideZero": false,"max": false,"min": false,"rightSide": true,"show": true,"sort": "current","sortDesc": true,"total": false,"values": true},"lines": true,"linewidth": 2,"links": [],"nullPointMode": "connected","options": {"alertThreshold": true},"paceLength": 10,"percentage": false,"pluginVersion": "7.5.2","pointradius": 5,"points": false,"renderer": "flot","seriesOverrides": [],"spaceLength": 10,"stack": false,"steppedLine": false,"targets": [{"expr": "sum by (queue)(rabbitmq_queue_messages_ready{queue!~\"^dead-letters.*\", namespace=~\"^$namespace$\"})","format": "time_series","interval": "","intervalFactor": 1,"legendFormat": "{{queue}}","metric": "rabbitmq_queue_messages_ready","refId": "A","step": 2},{"expr": "sum by (queue)(rabbitmq_queue_messages_published_total{queue!~\"^dead-letters.*\"})","format": "time_series","hide": true,"intervalFactor": 2,"legendFormat": "{{queue}}:published","metric": "rabbitmq_queue_messages_published_total","refId": "B","step": 2},{"expr": "sum by (queue)(rabbitmq_queue_messages_delivered_total{queue!~\"^dead-letters.*\"})","format": "time_series","hide": true,"intervalFactor": 2,"legendFormat": "{{queue}}:delivered","metric": "rabbitmq_queue_messages_delivered_total","refId": "C","step": 2},{"expr": "sum by (queue)(rabbitmq_queue_messages_unacknowledged{queue!~\"^dead-letters.*\"})","format": "time_series","hide": true,"intervalFactor": 2,"legendFormat": "{{queue}}:unack","metric": "ack","refId": "D","step": 2}],"thresholds": [],"timeFrom": null,"timeRegions": [],"timeShift": null,"title": "Currently in queues","tooltip": {"shared": true,"sort": 2,"value_type": "individual"},"type": "graph","xaxis": {"buckets": null,"mode": "time","name": null,"show": true,"values": []},"yaxes": [{"decimals": null,"format": "short","label": null,"logBase": 1,"max": null,"min": null,"show": true},{"decimals": null,"format": "short","label": null,"logBase": 1,"max": null,"min": null,"show": true}],"yaxis": {"align": false,"alignLevel": null}},{"aliasColors": {},"bars": false,"dashLength": 10,"dashes": false,"datasource": "Prometheus","decimals": 0,"fieldConfig": {"defaults": {},"overrides": []},"fill": 0,"fillGradient": 0,"gridPos": {"h": 9,"w": 12,"x": 0,"y": 16},"hiddenSeries": false,"id": 10,"legend": {"alignAsTable": true,"avg": true,"current": true,"hideEmpty": false,"hideZero": false,"max": false,"min": false,"rightSide": true,"show": true,"sort": "current","sortDesc": true,"total": false,"values": true},"lines": true,"linewidth": 2,"links": [],"nullPointMode": "connected","options": {"alertThreshold": true},"paceLength": 10,"percentage": false,"pluginVersion": "7.5.2","pointradius": 5,"points": false,"renderer": "flot","seriesOverrides": [],"spaceLength": 10,"stack": false,"steppedLine": false,"targets": [{"expr": "rabbitmq_queue_consumers{queue!~\"^dead-letters.*\",namespace=~\"^$namespace$\"}","format": "time_series","intervalFactor": 1,"legendFormat": "{{queue}}","refId": "A"}],"thresholds": [],"timeFrom": null,"timeRegions": [],"timeShift": null,"title": "Consumers per queue","tooltip": {"shared": true,"sort": 2,"value_type": "individual"},"type": "graph","xaxis": {"buckets": null,"mode": "time","name": null,"show": true,"values": []},"yaxes": [{"decimals": null,"format": "none","label": null,"logBase": 1,"max": null,"min": null,"show": true},{"format": "short","label": null,"logBase": 1,"max": null,"min": null,"show": false}],"yaxis": {"align": false,"alignLevel": null}},{"aliasColors": {},"bars": false,"dashLength": 10,"dashes": false,"datasource": "Prometheus","fieldConfig": {"defaults": {},"overrides": []},"fill": 0,"fillGradient": 0,"gridPos": {"h": 9,"w": 12,"x": 12,"y": 16},"hiddenSeries": false,"id": 16,"legend": {"alignAsTable": true,"avg": true,"current": true,"max": false,"min": false,"rightSide": true,"show": true,"sort": "avg","sortDesc": true,"total": false,"values": true},"lines": true,"linewidth": 2,"links": [],"nullPointMode": "connected","options": {"alertThreshold": true},"paceLength": 10,"percentage": false,"pluginVersion": "7.5.2","pointradius": 5,"points": false,"renderer": "flot","seriesOverrides": [],"spaceLength": 10,"stack": false,"steppedLine": true,"targets": [{"exemplar": true,"expr": "sum (rate(rabbitmq_channel_messages_delivered_ack_total{queue!~\"^dead-letters.*\", namespace=~\"^$namespace$\"}[1m])) by (queue) +\nsum (rate(rabbitmq_channel_messages_delivered_total{queue!~\"^dead-letters.*\", namespace=~\"^$namespace$\"}[1m])) by (queue) +\nsum (rate(rabbitmq_channel_messages_redelivered_total{queue!~\"^dead-letters.*\", namespace=~\"^$namespace$\"}[1m])) by (queue)","format": "time_series","interval": "10s","intervalFactor": 1,"legendFormat": "{{queue}}","refId": "A"}],"thresholds": [],"timeFrom": null,"timeRegions": [],"timeShift": null,"title": "Messages delivered / s","tooltip": {"shared": true,"sort": 2,"value_type": "individual"},"type": "graph","xaxis": {"buckets": null,"mode": "time","name": null,"show": true,"values": []},"yaxes": [{"format": "short","label": "Messages","logBase": 1,"max": null,"min": "0","show": true},{"format": "short","label": null,"logBase": 1,"max": null,"min": null,"show": true}],"yaxis": {"align": false,"alignLevel": null}}],"refresh": "1m","schemaVersion": 27,"style": "dark","tags": ["rabbitmq","prometheus"],"templating": {"list": [{"current": {"selected": false,"text": "Prometheus","value": "Prometheus"},"description": null,"error": null,"hide": 0,"includeAll": false,"label": null,"multi": false,"name": "datasource","options": [],"query": "prometheus","refresh": 1,"regex": "","skipUrlSync": false,"type": "datasource"},{"allValue": null,"current": {"selected": true,"tags": [],"text": ["All"],"value": ["$__all"]},"datasource": "Prometheus","definition": "","description": null,"error": null,"hide": 0,"includeAll": true,"label": null,"multi": true,"name": "node","options": [],"query": {"query": "label_values(rabbitmq_running, node)","refId": "Prometheus-node-Variable-Query"},"refresh": 1,"regex": "","skipUrlSync": false,"sort": 0,"tagValuesQuery": "","tags": [],"tagsQuery": "","type": "query","useTags": false},{"allValue": null,"current": {"selected": true,"tags": [],"text": ["All"],"value": ["$__all"]},"datasource": "Prometheus","definition": "label_values(namespace)","description": null,"error": null,"hide": 0,"includeAll": true,"label": null,"multi": true,"name": "namespace","options": [],"query": {"query": "label_values(namespace)","refId": "Prometheus-namespace-Variable-Query"},"refresh": 1,"regex": "","skipUrlSync": false,"sort": 0,"tagValuesQuery": "","tags": [],"tagsQuery": "","type": "query","useTags": false}]},"time": {"from": "now-1h","to": "now"},"timepicker": {"refresh_intervals": ["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options": ["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone": "browser","title": "RabbitMQ Monitoring","uid": "IgqkK8Xmz","version": 1}
